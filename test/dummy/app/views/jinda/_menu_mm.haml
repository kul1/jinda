- process_services
- Jinda::Module.all.asc(:seq).each do |m|
  - unless m.role.blank?
    - next unless login?
    - next unless current_ma_user.role
    - next unless current_ma_user.role.upcase.split(',').map!(&:strip).include?(m.role.upcase)

  %li.nav-item
    %span.nav-link.font-weight-bold= m.name

    %ul.list-unstyled.ms-3
      - m.services.asc(:seq).each do |s|
        - next unless s.list
        - xml= REXML::Document.new(s.xml).root
        - unless s.rule.blank?
          - next if (!eval(s.rule))
        - unless s.role.blank?
          - next unless login?
          - next unless current_ma_user.role
          - next unless current_ma_user.role.upcase.split(',').map!(&:strip).include?(s.role.upcase)
        - if s.code.downcase == 'link'
          - name, url = s.name.split(':', 2)
          - url.strip!
        - else
          - name= s.name; url= "/jinda/init?s=#{s.module_code}:#{s.code}"
        %li
          - if s.confirm
            = link_to name, url, class: 'nav-link', confirm: 'Please Confirm'
          - else
            = link_to name, url, class: 'nav-link'