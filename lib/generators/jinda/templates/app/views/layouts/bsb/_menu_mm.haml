%li.treeview
  - process_services
  - Jinda::Module.all.asc(:seq).each do |m|
    - unless m.role.blank?
      - next unless login?
      - next unless current_ma_user.role
      - next unless current_ma_user.role.upcase.split(&#39;,&#39;).map!(&amp; :strip).include?(m.role.upcase)
    %li.nav-item
      %a.nav-link{:href =&gt; &quot;javascript:void(0);&quot;}
        %i.material-icons.col-light-blue donut_small
        %span
        = m.name
      %ul.list-unstyled.ms-3
        - m.services.asc(:seq).each do |s|
          - next unless s.list
          - xml= REXML::Document.new(s.xml).root
          - unless s.rule.blank?
            - next if (!eval(s.rule))
          - unless s.role.blank?
            - next unless login?
            - next unless current_ma_user.role
            - next unless current_ma_user.role.upcase.split(&#39;,&#39;).map!(&amp; :strip).include?(s.role.upcase)
          - if s.code.downcase==&quot;link&quot;
            - name, url = s.name.split(&quot;:&quot;, 2)
            - url.strip!
          - else
            - name= s.name; url= &quot;/jinda/init?s=#{s.module_code}:#{s.code}&quot;
          - if s.confirm
            %li.nav-item
              %a.nav-link{:onclick=&gt;&quot;if (confirm(&#39;Please Confirm&#39;)) {location.href=&#39;#{url}&#39;}; return false;&quot;}= name
          - else
            %li.nav-item
              %a.nav-link{:href=&gt; url}= name